<div class="registro-container">
  <!-- Imagen lateral -->
  <div class="registro-imagen">
    <img src="/public/img/imagenVIaje.jpg" alt="Viaje" />
  </div>

  <!-- Formulario -->
  <div class="registro-formulario">
    <h2>Reg√≠strate</h2>
    <p>Configura tu cuenta para comenzar tu experiencia de viaje.</p>

    <!-- ‚úÖ Mensajes de estado -->
    <div *ngIf="message" class="mensaje-exito">{{ message }}</div>
    <div *ngIf="error" class="mensaje-error">{{ error }}</div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <!-- Nombre y Apellido -->
      <div class="nombre-apellido">
        <div class="nombre">
          <label for="nombre">Nombre</label>
          <input
            id="nombre"
            type="text"
            formControlName="nombre"
            placeholder="Tu nombre"
            [class.invalido]="campoInvalido('nombre')"
          />
        </div>

        <div class="apellido">
          <label for="apellido">Apellido</label>
          <input
            id="apellido"
            type="text"
            formControlName="apellido"
            placeholder="Tu apellido"
            [class.invalido]="campoInvalido('apellido')"
          />
        </div>
      </div>

      <!-- Email -->
      <div class="email">
        <label for="email">Correo electr√≥nico</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          placeholder="Tu correo"
          [class.invalido]="campoInvalido('email')"
        />
      </div>

      <!-- Contrase√±a -->
      <div class="password-container">
        <label for="password">Contrase√±a</label>
        <div class="password-field">
          <input
            id="password"
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            placeholder="Tu contrase√±a (Mayor a 6 d√≠gitos)"
            [class.invalido]="campoInvalido('password')"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="togglePassword()"
            aria-label="Mostrar u ocultar contrase√±a"
          >
            <!-- CAMBIO: √çconos de Font Awesome -->
            <i [class]="showPassword ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash'"></i>
          </button>
        </div>
        
        <!-- AVISO DE VALIDACI√ìN DE MINLENGTH -->
        <small 
          *ngIf="registerForm.get('password')?.hasError('minlength') && (registerForm.get('password')?.dirty || registerForm.get('password')?.touched)" 
          class="mensaje-error"
        >
          La contrase√±a debe tener al menos 6 caracteres.
        </small>
        <!-- /AVISO DE VALIDACI√ìN -->
      </div>

      <!-- Confirmar contrase√±a -->
      <div class="password-container">
        <label for="confirmPassword">Confirmar contrase√±a</label>
        <div class="password-field">
          <input
            id="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            formControlName="confirmPassword"
            placeholder="Ingresa nuevamente tu contrase√±a"
            [class.invalido]="
              campoInvalido('confirmPassword') ||
              registerForm.hasError('passwordMismatch')
            "
          />
          <button
            type="button"
            class="toggle-password"
            (click)="toggleConfirmPassword()"
            aria-label="Mostrar u ocultar confirmaci√≥n de contrase√±a"
          >
            <!-- CAMBIO: √çconos de Font Awesome -->
            <i [class]="showConfirmPassword ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash'"></i>
          </button>
        </div>

        <!-- üî¥ Mensaje espec√≠fico para contrase√±as no coincidentes -->
        <small *ngIf="registerForm.hasError('passwordMismatch')" class="mensaje-error">
          Las contrase√±as no coinciden.
        </small>
      </div>

      <!-- Selector de Rol -->
      <div class="rol">
        <label for="rol">Tipo de cuenta</label>
        <select id="rol" formControlName="rol">
          <option value="viajero">Viajero</option>
          <option value="proveedor">Proveedor</option>
        </select>
      </div>

      <!-- Bot√≥n -->
      <!-- Es importante mantener la deshabilitaci√≥n basada en la invalidez del formulario -->
      <button type="submit" [disabled]="registerForm.invalid || isSubmitting">
        {{ isSubmitting ? 'Creando cuenta...' : 'Crear cuenta' }}
      </button>

      <!-- Enlace a login -->
      <p class="login-link">
        ¬øYa tienes una cuenta?
        <a routerLink="/login">Inicia Sesion</a>
      </p>
    </form>
  </div>
</div>
